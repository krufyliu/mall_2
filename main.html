<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>		
		<link rel="stylesheet" href="css/mui.min.css" />
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="css/bootstrap-theme.min.css" />
		<link rel="stylesheet" href="css/font-awesome.min.css" />
		<link rel="stylesheet" href="css/style.css" />
		<script>
			function imgLoaded(img) {
        var imgWrapper = img.parentNode;
        imgWrapper.className += imgWrapper.className? ' loaded' : 'loaded';
      }
		</script>
	</head>

	<body>
		<nav class="mui-bar mui-bar-tab">
		  <li class="mui-tab-item mui-active" id="home">
				<span class="mui-icon fa fa-home fa-2x"></span>
				<span class="mui-tab-label">首页</span>
			</li>
			<li class="mui-tab-item" id="walk">
				<span class="mui-icon fa fa-rocket fa-2x"></span>
				<span class="mui-tab-label">走街串巷</span>
			</li>
			<li class="mui-tab-item" id="setting">
				<span class="mui-icon fa fa-user fa-2x"></span>
				<span class="mui-tab-label">我的</span>
			</li>
		</nav>

		<script src="js/mui.min.js"></script>
		<script src="js/app.js"></script>
		<script>
			(function($, doc) {
				$.init({
					swipeBack: false,
					statusBarBackground: '#f7f7f7',
					gestureConfig: {
						doubletap: true
					}
				});
				var settings = app.getSettings();
				var account = doc.getElementById('account');
				

				
				$.plusReady(function() {
				  
					var showGuide = plus.storage.getItem("lauchFlag");
					if(showGuide){
						//有值，说明已经显示过了，无需显示；
						//关闭splash页面；
						plus.navigator.closeSplashscreen();
						plus.navigator.setFullscreen(false);
					}else{
						//显示启动导航
						mui.openWindow({
							id:'guide',
							url:'plus/guide.html',
							show:{
								aniShow:'fade-in'
							},
							waiting:{
								autoShow:true
							}
						});
					}
					
					var self = plus.webview.currentWebview();
					var pages = [{
						id: 'home',
						url: 'plus/index.html',
						styles: {
							top: '0px',
							bottom: '45px'
						}
					},{
						id: 'walk',
						url: 'plus/walk.html',
						styles: {
							top: '0px',
							bottom: '45px'
						}
					},{
						id: 'setting',
						url: 'plus/setting.html',
						styles: {
							top: '0px',
							bottom: '45px'
						}
					}];
					for (var i = 0; i < 3; i++){
						var sub = plus.webview.create(pages[i].url, pages[i].id, pages[i].styles);
						if (i > 0){
							sub.hide();
						}
						self.append(sub);
					}

					var homeButton = doc.getElementById('home');
					var walkButton = doc.getElementById('walk');
					var settingButton = doc.getElementById('setting');
					homeButton.addEventListener('tap', function(event) {
						plus.webview.show('home');
						plus.webview.hide('walk');
						plus.webview.hide('setting');
						
					});
					walkButton.addEventListener('tap', function(event) {
						plus.webview.show('walk');
						plus.webview.hide('home');
						plus.webview.hide('setting');
						
					});
					settingButton.addEventListener('tap', function(event) {
						plus.webview.show('setting');
						plus.webview.hide('walk');
						plus.webview.hide('home');
					});
					
					$.oldBack = mui.back;
					var backButtonPress = 0;
					$.back = function(event) {
						backButtonPress++;
						if (backButtonPress > 1) {
							plus.runtime.quit();
						} else {
							plus.nativeUI.toast('再按一次退出应用');
						}
						setTimeout(function() {
							backButtonPress = 0;
						}, 1000);
						return false;
					};
				});
			}(mui, document));
		</script>
	</body>

</html>