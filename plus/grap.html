<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link rel="stylesheet" href="../css/mui.min.css" />
		<link rel="stylesheet" href="../css/bootstrap.min.css" />
		<link rel="stylesheet" href="../css/bootstrap-theme.min.css" />
		<link rel="stylesheet" href="../css/font-awesome.min.css" />
		<link rel="stylesheet" href="../css/style.css" />
		<link rel="stylesheet" href="../css/mui.indexedlist.css" />
		<script>
			function imgLoaded(img) {
				var imgWrapper = img.parentNode;
				imgWrapper.className += imgWrapper.className? ' loaded' : 'loaded';
			}
		</script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<button type="button" class="mui-left mui-action-back mui-btn  mui-btn-link mui-btn-nav mui-pull-left">
				<span class="mui-icon mui-icon-left-nav"></span>返回
			</button>
			<h1 class="mui-center mui-title">抢优惠</h1>
			<button type="button" id="heart" status="0" class="mui-pull-right mui-btn-link" style="font-size: 12px; padding-right: 2px;"><i class="fa fa-heart-o fa-2x"></i></button>
		</header>
		<div class="mui-content mui-scroll-wrapper" id="refreshContainer" style="padding-top: 60px;">
			<div class="mui-scroll">
				<div class="container">
					<div class="row" id="post-list">
						<div class="col-xs-12 col-sm-6">
						<article class="post tag-ad collect danger">
							<h2 class="post-title" style="padding: 0px 10px;">
								<span class="pull-left mui-badge mui-ellipsis title" id="merchant.html?shop=1" onclick="clicked(this.id);">肯德基大新店</span>
								<span class="mui-badge">&nbsp;09-09&nbsp;10:10</span>
								<span class="pull-right">剩余<span class="mui-badge">500</span>张</span>
							</h2>
						<div class="post-featured-image">
						<a class="thumbnail loaded" href="#" target="_blank">
						  <img src="http://static.bootcss.com/expo/img/7/b5/f9c2f01fad1f23574156e0577a06c.jpg" width="800" height="600" alt="Ghost中文网" onload="imgLoaded(this)">
						</a>
						</div>
						<span class="badge type">立即抢券</span>
						<span class="badge price">￥50</span>
						<span class="badge description">满100使用</span>
						</article>
						</div>
						<div class="col-xs-12 col-sm-6">
						<article class="post tag-ad collect danger">
							<h2 class="post-title" style="padding: 0px 10px;">
								<span class="pull-left mui-badge mui-ellipsis title" id="merchant.html?shop=1" onclick="clicked(this.id);">肯德基大新店</span>
								<span class="mui-badge">&nbsp;09-09&nbsp;10:10</span>
								<span class="pull-right">剩余<span class="mui-badge">500</span>张</span>
							</h2>
						<div class="post-featured-image">
						<a class="thumbnail loaded" href="#" target="_blank">
						  <img src="http://static.bootcss.com/expo/img/7/b5/f9c2f01fad1f23574156e0577a06c.jpg" width="800" height="600" alt="Ghost中文网" onload="imgLoaded(this)">
						</a>
						</div>
						<span class="badge type">立即抢券</span>
						<span class="badge price">￥50</span>
						<span class="badge description">满100使用</span>
						</article>
						</div>
						<div class="col-xs-12 col-sm-6">
						<article class="post tag-ad collect danger">
							<h2 class="post-title" style="padding: 0px 10px;">
								<span class="pull-left mui-badge mui-ellipsis title" id="merchant.html?shop=2" onclick="clicked(this.id);">肯德基大新店</span>
								<span class="mui-badge">&nbsp;09-09&nbsp;10:10</span>
								<span class="pull-right">剩余<span class="mui-badge">500</span>张</span>
							</h2>
						<div class="post-featured-image">
						<a class="thumbnail loaded" href="#" target="_blank">
						  <img src="http://static.bootcss.com/expo/img/7/b5/f9c2f01fad1f23574156e0577a06c.jpg" width="800" height="600" alt="Ghost中文网" onload="imgLoaded(this)">
						</a>
						</div>
						<span class="badge type">立即抢券</span>
						<span class="badge price">￥50</span>
						<span class="badge description">满100使用</span>
						</article>
						</div>
						<div class="col-xs-12 col-sm-6">
						<article class="post tag-ad collect warning">
							<h2 class="post-title" style="padding: 0px 10px;">
								<span class="pull-left mui-badge mui-ellipsis title" id="merchant.html?shop=3" onclick="clicked(this.id);">马云烧烤店</span>
								<span class="mui-badge">&nbsp;09-09&nbsp;10:10</span>
								<span class="pull-right">剩余<span class="mui-badge">200</span>张</span>
							</h2>
						<div class="post-featured-image">
						<a class="thumbnail loaded" href="#" target="_blank">
						  <img src="http://static.bootcss.com/expo/img/7/b5/f9c2f01fad1f23574156e0577a06c.jpg" width="800" height="600" alt="Ghost中文网" onload="imgLoaded(this)">
						</a>
						</div>
						<span class="badge type">未开始</span>
						<span class="badge price">￥50</span>
						<span class="badge description">满100使用</span>
						</article>
						</div>
						<div class="col-xs-12 col-sm-6">
						<article class="post tag-ad collect">
							<h2 class="post-title" style="padding: 0px 10px;">
								<span class="pull-left mui-badge mui-ellipsis title" id="merchant.html?shop=4" onclick="clicked(this.id);">马化腾叉烧</span>
								<span class="mui-badge">&nbsp;09-09&nbsp;10:10</span>
								<span class="pull-right">剩余<span class="mui-badge">0</span>张</span>
							</h2>
						<div class="post-featured-image">
						<a class="thumbnail loaded" href="#" target="_blank">
						  <img src="http://static.bootcss.com/expo/img/7/b5/f9c2f01fad1f23574156e0577a06c.jpg" width="800" height="600" alt="Ghost中文网" onload="imgLoaded(this)">
						</a>
						</div>
						<span class="badge type">已抢完</span>
						<span class="badge price">￥50</span>
						<span class="badge description">满100使用</span>
						</article>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<script src="../js/mui.min.js"></script>
		<script src="../js/app.js"></script>
		<script src="../js/mui.indexedlist.js"></script>
		<script type="text/javascript" charset="utf-8">
			mui.plusReady(function() {
				var currentShop = null;
				//初始化单页的区域滚动
				mui('.mui-scroll-wrapper').scroll();
				
				var pullfresh = function() {
					setTimeout(function() {
						mui('#refreshContainer').pullRefresh().endPulldownToRefresh();
					}, 3000);
				}
				
				mui.init({
					pullRefresh : {
						container:"#refreshContainer",//下拉刷新容器标识，querySelector能定位的css选择器均可，比如：id、.class等
						down : {
							  contentdown : "下拉可以刷新",//可选，在下拉可刷新状态时，下拉刷新控件上显示的标题内容
							  contentover : "释放立即刷新",//可选，在释放可刷新状态时，下拉刷新控件上显示的标题内容
							  contentrefresh : "正在刷新...",//可选，正在刷新状态时，下拉刷新控件上显示的标题内容
							  callback :pullfresh //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
						}
					}
				});
				
				window.addEventListener('grapRefresh', function(e){
					currentShop = e.detail.shop;
					console.log('grap refresh', JSON.stringify(e.detail));
				});
			
				// H5 plus事件处理
				function plusReady(){
					// 隐藏滚动条
					plus.webview.currentWebview().setStyle({scrollIndicator:'none'});
					// Android处理返回键
					
					compatibleAdjust();
				}
				if(window.plus){
					plusReady();
				}else{
					document.addEventListener('plusready',plusReady,false);
				}
				// DOMContentLoaded事件处理
				var _domReady=false;
				document.addEventListener('DOMContentLoaded',function(){
					_domReady=true;
					compatibleAdjust();
				},false);
				var _adjust=false;
				function compatibleAdjust(){
					if(_adjust||!window.plus||!_domReady){
						return;
					}
					_adjust=true;

					// 预创建二级窗口
				//	preateWebviews();
					// 关闭启动界面
					setTimeout(function(){
						plus.navigator.closeSplashscreen();
					},500);
				}
				var heart = document.getElementById('heart');
				heart.addEventListener('click', function(event){
					if (heart.status == 0){
						heart.status = 1;
						heart.innerHTML = "<i class='fa fa-heart-o fa-2x'></i>";
						plus.nativeUI.toast('已取消收藏！');
					} else {
						heart.status = 0;
						heart.innerHTML = "<i class='fa fa-heart fa-2x'></i>";
						plus.nativeUI.toast('收藏成功！');
					}
				});
				//抢券
				mui('#post-list').on('tap', '.collect .type', function(event) {
					var elem = this;
					if(elem.innerText!="已抢" && elem.innerText!="未开始" && elem.innerText!="已抢完"){
						elem.className = elem.className.replace("badge-danger", "badge-success");
						var parent = elem.parentNode;
						parent.className = parent.className.replace("danger", "success");
						elem.innerText = "已抢";
						plus.nativeUI.toast('抢券成功！');
					}
				});
			});
		</script>
	</body>

</html>